name: Build
description: Builds a Docker image
inputs:
  app_name:
    required: true
    description: Application name
  app_version:
    required: true
    description: Application version

runs:
  using: composite
  steps:
    - uses: ashep/go-ci-github/actions/prepare@main
    - run: task docker:build
      shell: bash
      env:
        TASK_APP_NAME: ${{ inputs.app_name }}
        TASK_APP_VERSION: ${{ inputs.app_version }}
    - run: task docker:save
      shell: bash
      env:
        TASK_APP_NAME: ${{ inputs.app_name }}
        TASK_APP_VERSION: ${{ inputs.app_version }}
    - uses: actions/upload-artifact@v3
      with:
        name: app_image
        path: tmp/{{ inputs.app_name }}_${{ inputs.app_version }}.tar
        retention-days: 1
